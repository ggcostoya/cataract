<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with R packages • cataract</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with R packages">
<meta property="og:description" content="cataract">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cataract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/git.html">What is Git?</a>
</li>
<li>
  <a href="../articles/r_packages.html">R packages</a>
</li>
<li>
  <a href="../articles/github.html">What is GitHub?</a>
</li>
<li class="dropdown-header">GitHub Pages</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="r_packages_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="r_packages_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with R packages</h1>
            
      
      
      <div class="hidden name"><code>r_packages.Rmd</code></div>

    </div>

    
    
<div id="aim-of-the-game" class="section level3">
<h3 class="hasAnchor">
<a href="#aim-of-the-game" class="anchor"></a><strong>Aim of the Game</strong>
</h3>
<p>Have you ever been in that situation where your R script is longer than the Wall of China? Something like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># first remove everything on the environment</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># then install the packages you need </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">install.packages</span>(<span class="st">"ggplot2"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">install.packages</span>(<span class="st">"nlmer"</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">install.packages</span>(<span class="st">"rethinking"</span>)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">install.packages</span>(<span class="st">"whatever"</span>)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">install.packages</span>(<span class="st">"some bullshit I need 4 just that one line"</span>)</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># then load the packages </span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">library</span>(nlmer)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">library</span>(rethinking)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">library</span>(whatever)</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">library</span>(some bullshit I need <span class="dv">4</span> just that one line)</a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># then load the data </span></a>
<a class="sourceLine" id="cb1-19" title="19">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(C<span class="op">:</span><span class="er">/</span>was_it_this_folder?<span class="op">/</span>within_this_one?<span class="op">/</span>not_sure<span class="op">/</span>maybe_here?<span class="op">/</span>data.csv)</a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># then tidy the raw data and only keep what you need for your analysis </span></a>
<a class="sourceLine" id="cb1-22" title="22">actual_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">unicorn_id =</span> data<span class="op">$</span>UniCorn_Identity,</a>
<a class="sourceLine" id="cb1-23" title="23">                          <span class="dt">horn_length =</span> data<span class="op">$</span>Length_of_THe_horn_of_the_UNicorn, </a>
<a class="sourceLine" id="cb1-24" title="24">                          <span class="dt">weight =</span> data<span class="op">$</span>W_of_the_Unicorn_when_born)</a>
<a class="sourceLine" id="cb1-25" title="25"></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co"># to then finally be able to run the fricking analysis </span></a>
<a class="sourceLine" id="cb1-27" title="27">model &lt;-<span class="st"> </span><span class="kw">lm</span>(horn_length <span class="op">~</span><span class="st"> </span>weight, actual_data)</a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co"># to then get a fricking ERROR AGAIN GODDAMN IT! </span></a></code></pre></div>
<p>That is waaay too long and sooo frustrating! But worry no more! There is a way to solve this and it is treating your entire project as an <strong>R package</strong>. Let me explain</p>
</div>
<div id="what-is-an-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-an-r-package" class="anchor"></a><strong>What is an R package?</strong>
</h3>
<p>An <strong>R package</strong> is a type of <strong>R project</strong>, in other words, a folder you set up and in which you can do all your project work. An R package works exactly like those packages you install and load every time you load a script (i.e <code>ggplot2</code>, <code>nlmer</code> etc.) when you need a function that does something useful. However, this time, you will be the person behind the scenes! A package can include, <strong>functions</strong>, <strong>data</strong>, and all kinds of <strong>scripts</strong> to process or document your work. As an example, I have developed the package <code>cataract</code>. I can load this package and with it I can specify other packages that need to be both installed and loaded with it.</p>
<p>When loading the package I can also access functions that I have written specifically to perform certain tasks without having to load anything. For example, here is a function that generates facts about Chris with at 1-5 levels of spicyness:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/generate_chris_fact.html">generate_chris_fact</a></span><span class="op">(</span>spicyness <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Chris has an awesome mustache"</code></pre>
<p>And, at the same time, I can access any datasets I am working with. I can save them after being processed and with the variables I want so when I load them they are ready to be played with. As an example, I have added some meerkat data from a previous project to the <code>cataract</code> project. Here is the head of it:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">meerkats</span><span class="op">)</span></code></pre></div>
<pre><code>##   obs_feeds obs_hours r_2_brood  group_id brood_id delta_mass
## 1         0      11.1      0.25 bfb_c_sfi  bfb0802      -0.03
## 2         0      11.2      0.25 bfb_c_sfi  bfb0802       0.28
## 3         0      12.8      0.25 bfb_c_sfi  bfb0802      -0.08
## 4         3      12.6      0.25 bfb_c_sfi  bfb0802       0.31
## 5        16      12.2      0.25 bfb_c_sfi  bfb0802       0.17
## 6        12      11.5      0.25 bfb_c_sfi  bfb0802       0.14</code></pre>
<p>And this is just the tip of the iceberg!</p>
</div>
<div id="creating-your-own-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-your-own-r-package" class="anchor"></a><strong>Creating your own R package</strong>
</h3>
<p><em>Okay dude but how in the hell do you actually do this?</em> No problem! Here is a step by step tutorial for you:</p>
<div id="step-1" class="section level5">
<h5 class="hasAnchor">
<a href="#step-1" class="anchor"></a><strong>Step 1</strong>
</h5>
<p>Have you ever noticed when you open Rstudio that little <strong>R</strong> sign that says something like <code>Project:(None)</code>. Click there and go to <code>New Project</code>.</p>
<center>
<img src="images/rpak_project_none.png">
</center>
<p><br></p>
</div>
<div id="step-2" class="section level5">
<h5 class="hasAnchor">
<a href="#step-2" class="anchor"></a><strong>Step 2</strong>
</h5>
<p>Then this window will pop up, we want a <code>New Directory</code></p>
<br><center>
<img src="images/rpak_create_project.png" width="600">
</center>
<p><br></p>
</div>
<div id="step-3" class="section level5">
<h5 class="hasAnchor">
<a href="#step-3" class="anchor"></a><strong>Step 3</strong>
</h5>
<p>Here we will choose <code>R package</code>.</p>
<br><center>
<img src="images/rpak_project_type.png" width="600">
</center>
<p><br></p>
</div>
<div id="step-4" class="section level5">
<h5 class="hasAnchor">
<a href="#step-4" class="anchor"></a><strong>Step 4</strong>
</h5>
<p>Which will open this:</p>
<br><center>
<img src="images/rpak_create_package.png" width="600">
</center>
<p><br></p>
<p>Three things to consider here:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>
<strong>Name of your package</strong>: Package naming needs to meet certain formalities. In this link: <a href="https://r-pkgs.org/workflows101.html?q=namin#naming" class="uri">https://r-pkgs.org/workflows101.html?q=namin#naming</a> you will find them as well as some pragmatic advice on naming. My personal recommendation is to name your packages with a single word that is descriptive enough and that motivates you to work on it. What I do is name my packages using extremely geeky associations which are related with what the package is about in a funny way.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>
<strong>Make sure you create the folder for the package on a directory you know!</strong>: You can set it up on your Desktop, that’s fine! But remember it is there!. What I recommend, as kind of a technological tidyness nerd is to create a specialized folder for <code>projects</code> where you can locate all your work!</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>
<strong>Don’t forget about GIT!</strong> If you followed my presentation or have checked other pages before this one within <em>Project Catract</em> you should have <strong>GIT</strong> installed in your computer right now (if not go to the <strong>What is Git?</strong> page and check that out). If you indeed have it, a little check box with <code>Create git repository</code> should appear in this screen. Be sure to check that box! It will be essential later.</li>
</ol></li>
</ul>
<p>Once you are done, click on <code>Create Project</code> and KABOOM! Congrats! You’ve created your first R package, now it’s time to see what is going on here.</p>
</div>
</div>
<div id="elements-of-your-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#elements-of-your-r-package" class="anchor"></a><strong>Elements of your R package</strong>
</h3>
<p>As soon as you create your R package you will see that a bunch of folders automatically appear on the folder for it. You can see these in the lower right-hand panel in Rstudio where it says <code>Files</code>, it should look something like this:</p>
<br><center>
<img src="images/rpak_files.png" width="600">
</center>
<p><br></p>
<p>Among these files and documents the ones you got to pay attention to are:</p>
<div id="rproj" class="section level4">
<h4 class="hasAnchor">
<a href="#rproj" class="anchor"></a><strong>.Rproj</strong>
</h4>
<p>The <code>.Rproj</code> file is the source to all of your R packge. In this case, as an example, I’ve created the <code>kurama</code> package so in the picture above you see <code>kurama.Rproj</code>. When you create projects of your own the <code>.Rproj</code> file will be your package’s name. If you go to the folder where you created the package and click on it an R session with your package name will appear. Notice also that on the top right hand side it doesn’t say <code>Project:(None)</code> anymore! The name of your package should appear up there.</p>
</div>
<div id="description" class="section level4">
<h4 class="hasAnchor">
<a href="#description" class="anchor"></a><strong>DESCRIPTION</strong>
</h4>
<p>The <code>DESCRIPTION</code> file contains all the information related to your project. If you open it, it should look like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Package<span class="op">:</span><span class="st"> </span>kurama <span class="co"># here's my example, but here the name of your package will appear. </span></a>
<a class="sourceLine" id="cb6-2" title="2">Type<span class="op">:</span><span class="st"> </span>Package</a>
<a class="sourceLine" id="cb6-3" title="3">Title<span class="op">:</span><span class="st"> </span>What the Package <span class="kw">Does</span> (Title Case)</a>
<a class="sourceLine" id="cb6-4" title="4">Version<span class="op">:</span><span class="st"> </span><span class="dv">0</span>.<span class="fl">1.0</span></a>
<a class="sourceLine" id="cb6-5" title="5">Author<span class="op">:</span><span class="st"> </span>Who wrote it</a>
<a class="sourceLine" id="cb6-6" title="6">Maintainer<span class="op">:</span><span class="st"> </span>The package maintainer <span class="op">&lt;</span>yourself<span class="op">@</span>somewhere.net<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb6-7" title="7">Description<span class="op">:</span><span class="st"> </span>More about what it <span class="kw">does</span> (maybe more than one line)</a>
<a class="sourceLine" id="cb6-8" title="8">    Use four spaces when indenting paragraphs within the Description.</a>
<a class="sourceLine" id="cb6-9" title="9">License<span class="op">:</span><span class="st"> </span>What license is it under?</a>
<a class="sourceLine" id="cb6-10" title="10">Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="dv">-8</span></a>
<a class="sourceLine" id="cb6-11" title="11">LazyData<span class="op">:</span><span class="st"> </span>true</a></code></pre></div>
<p>The <code>DESCRIPTION</code> file can include all <strong>Dependencies</strong>, which are all packages that need to be installed and loaded for your package to run. You will need to add them manually so your <code>DESCRIPTION</code> file looks like:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">Package<span class="op">:</span><span class="st"> </span>kurama <span class="co"># here's my example, but here the name of your package will appear. </span></a>
<a class="sourceLine" id="cb7-2" title="2">Type<span class="op">:</span><span class="st"> </span>Package</a>
<a class="sourceLine" id="cb7-3" title="3">Title<span class="op">:</span><span class="st"> </span>What the Package <span class="kw">Does</span> (Title Case)</a>
<a class="sourceLine" id="cb7-4" title="4">Version<span class="op">:</span><span class="st"> </span><span class="dv">0</span>.<span class="fl">1.0</span></a>
<a class="sourceLine" id="cb7-5" title="5">Author<span class="op">:</span><span class="st"> </span>Who wrote it</a>
<a class="sourceLine" id="cb7-6" title="6">Maintainer<span class="op">:</span><span class="st"> </span>The package maintainer <span class="op">&lt;</span>yourself<span class="op">@</span>somewhere.net<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-7" title="7">Description<span class="op">:</span><span class="st"> </span>More about what it <span class="kw">does</span> (maybe more than one line)</a>
<a class="sourceLine" id="cb7-8" title="8">    Use four spaces when indenting paragraphs within the Description.</a>
<a class="sourceLine" id="cb7-9" title="9">License<span class="op">:</span><span class="st"> </span>What license is it under?</a>
<a class="sourceLine" id="cb7-10" title="10">Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="dv">-8</span></a>
<a class="sourceLine" id="cb7-11" title="11">LazyData<span class="op">:</span><span class="st"> </span>true</a>
<a class="sourceLine" id="cb7-12" title="12">Dependencies<span class="op">:</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="st">    </span><span class="kw">R</span>(<span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>.<span class="fl">3.0</span>), <span class="co"># specify the version of R needed to run your package</span></a>
<a class="sourceLine" id="cb7-14" title="14">    tidyverse, <span class="co"># packages that need to be installed and loaded for your project to run </span></a>
<a class="sourceLine" id="cb7-15" title="15">    devtools,</a>
<a class="sourceLine" id="cb7-16" title="16">    DescTools, </a>
<a class="sourceLine" id="cb7-17" title="17">    gridExtra,</a>
<a class="sourceLine" id="cb7-18" title="18">    here</a>
<a class="sourceLine" id="cb7-19" title="19">RoxygenNote<span class="op">:</span><span class="st"> </span><span class="dv">7</span>.<span class="fl">1.1</span> <span class="co"># do me a favor and include this too, I'll get back to it later ;) </span></a></code></pre></div>
<p>Setting up a <code>DESCRIPTION</code> file like this saves you the trouble of having to install and load packages everytime. You just need to include them as <em>Dependencies</em> and BOOM! They will be loaded every time you load your project, which btw you can do using this command:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="r" class="section level4">
<h4 class="hasAnchor">
<a href="#r" class="anchor"></a><strong>R</strong>
</h4>
<p>The <code>R</code> folder will contain all the functions for your package. If you click there you’ll see that R has automatically created a function called <code>hello</code>, which is saved on the <code>hello.R</code> file that looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Hello, world!</span>
<span class="co">#</span>
<span class="co"># This is an example function named 'hello' </span>
<span class="co"># which prints 'Hello, world!'.</span>
<span class="co">#</span>
<span class="co"># You can learn more about package authoring with RStudio at:</span>
<span class="co">#</span>
<span class="co">#   http://r-pkgs.had.co.nz/</span>
<span class="co">#</span>
<span class="co"># Some useful keyboard shortcuts for package authoring:</span>
<span class="co">#</span>
<span class="co">#   Install Package:           'Ctrl + Shift + B'</span>
<span class="co">#   Check Package:             'Ctrl + Shift + E'</span>
<span class="co">#   Test Package:              'Ctrl + Shift + T'</span>

<span class="va">hello</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Hello, world!"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The goal here is that you create functions for yourself to make some of the tasks within your package easier and more repeatable. Writing your own functions is a way to avoid repetitions within your code. For example, let’s say that for the <code>meerkats</code> dataset I showed you earlier I want to determine the mean number of feeding observations (<code>obs_feeds</code>) for a given brood.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's check the data first once again: </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">meerkats</span><span class="op">)</span></code></pre></div>
<pre><code>##   obs_feeds obs_hours r_2_brood  group_id brood_id delta_mass
## 1         0      11.1      0.25 bfb_c_sfi  bfb0802      -0.03
## 2         0      11.2      0.25 bfb_c_sfi  bfb0802       0.28
## 3         0      12.8      0.25 bfb_c_sfi  bfb0802      -0.08
## 4         3      12.6      0.25 bfb_c_sfi  bfb0802       0.31
## 5        16      12.2      0.25 bfb_c_sfi  bfb0802       0.17
## 6        12      11.5      0.25 bfb_c_sfi  bfb0802       0.14</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's say that I want to determine the mean obs_feeds for the "bfb0802" brood</span>

<span class="co"># first I filter the data to get only the "bfb0802" brood</span>
<span class="va">brood_I_want</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">meerkats</span>, <span class="va">brood_id</span> <span class="op">==</span> <span class="st">"bfb0802"</span><span class="op">)</span> <span class="co"># note: "filter" is a very useful function from the "tidyverse" package, included as a dependency for the `cataract` package so no need to load or install, I can just use it like this! ;) </span>

<span class="co"># then get the mean for that brood</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">brood_I_want</span><span class="op">$</span><span class="va">obs_feeds</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 8.111111</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># if I needed to extract the mean for all broods that could be a very tedious process, </span>
<span class="co"># so I can write a function to automate this process. I can call this function "extract_mean_feeds": </span>

<span class="va">get_mean_feeds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">brood_id_I_want</span><span class="op">)</span><span class="op">{</span> <span class="co"># start the function. it takes one argument: brood id</span>
  
  <span class="co"># first, it filters the meerkat data to the brood I need </span>
  <span class="va">brood_I_want_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">meerkats</span>, <span class="va">brood_id</span> <span class="op">==</span> <span class="va">brood_id_I_want</span><span class="op">)</span>
  
  <span class="co"># get the mean obs_feeds for that brood </span>
  <span class="va">mean_obs_feeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">brood_I_want_data</span><span class="op">$</span><span class="va">obs_feeds</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  
  <span class="co"># return that mean as the output of the function</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mean_obs_feeds</span><span class="op">)</span>
  
  <span class="op">}</span> <span class="co"># end the function</span>

<span class="co"># let's test the function out </span>
<span class="fu"><a href="../reference/get_mean_feeds.html">get_mean_feeds</a></span><span class="op">(</span>brood_id_I_want <span class="op">=</span> <span class="st">"bfb0802"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 8.111111</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># AWESOME! It worked! And now with a bit of R magic we can do in one line what </span>
<span class="co"># would have taken around 40 and get the mean obs_feeds for all broods! </span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>obs_feeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">meerkats</span><span class="op">$</span><span class="va">brood_id</span><span class="op">)</span><span class="op">)</span>, <span class="va">get_mean_feeds</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##          obs_feeds
## bfb0802   8.111111
## bfd0702  25.800000
## bfd0801  14.400000
## bfd0802  19.033333
## ceb20701 43.727273
## ceb20801 44.333333</code></pre>
<p>If you check the <code>R</code> folder for the <code>cataract</code> package here: <a href="https://github.com/ggcostoya/cataract/tree/master/R" class="uri">https://github.com/ggcostoya/cataract/tree/master/R</a> , you’ll see that one of the files there is for the <code>extract_mean_feeds</code> function. If it is there I can use it any time <code>cataract</code> is loaded!</p>
</div>
<div id="gitignore" class="section level4">
<h4 class="hasAnchor">
<a href="#gitignore" class="anchor"></a><strong>.gitignore</strong>
</h4>
<p>The <code>.gitignore</code> file will specify which files or folders you don’t want <strong>GIT</strong> to keep track of version-control style. For example, a good addition to <code>.gitignore</code> is the <code>.Rproj</code> file, it will never change, why keep track of it?</p>
<p>These are the basic things you need to have, but to upgrade your R package to the next level you’ll need to create the following folders:</p>
</div>
<div id="raw_data" class="section level4">
<h4 class="hasAnchor">
<a href="#raw_data" class="anchor"></a><strong>raw_data</strong>
</h4>
<p>In the <code>raw_data</code> folder you will save all data that comes fresh from the field or the lab. I am talking about those messy excels, .txt files, .csv files anything! All in there. The raw data folder will also contain what I call <strong>cleaning scripts</strong>. These will have all the data processing, filtering and cleaning necessary for your raw data to become the actual data you’ll use in your scripts. If you go to: <a href="https://github.com/ggcostoya/cataract/tree/master/raw_data" class="uri">https://github.com/ggcostoya/cataract/tree/master/raw_data</a>, you’ll be able to see the raw <code>meerkats</code> data I’ve been using for this project and how using this script:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Meerkat data preparation</span>

<span class="co"># load here package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krlmlr/here">here</a></span><span class="op">)</span>

<span class="co"># load the meerkat data</span>
<span class="va">meerkats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"raw_data"</span>, <span class="st">"meerkats.txt"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># rename some columns</span>
<span class="va">meerkats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>obs_feeds <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">observedNfeeds</span>,
                       obs_hours <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">observedhours</span>,
                       r_2_brood <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">relatedness2brood</span>,
                       group_id <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">socialgroupID</span>,
                       brood_id <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">broodID</span>,
                       delta_mass <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">massChange</span><span class="op">)</span>

<span class="co"># save meerkat data in "data" folder</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">meerkats</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data"</span>, <span class="st">"meerkats.RData"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>I read it, rename variables and save it in the <code>data</code> folder.</p>
</div>
<div id="data" class="section level4">
<h4 class="hasAnchor">
<a href="#data" class="anchor"></a><strong>data</strong>
</h4>
<p>The <code>data</code> folder will contain the actual data you will use in your scripts (in <code>.RData</code> format) and will be available to you inmediately after you load your R package. Once again, as an example, I can take a look at the <code>meerkats</code> data without having to load anything because it is saved in the <code>data</code> folder.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">meerkats</span><span class="op">)</span></code></pre></div>
<pre><code>##   obs_feeds obs_hours r_2_brood  group_id brood_id delta_mass
## 1         0      11.1      0.25 bfb_c_sfi  bfb0802      -0.03
## 2         0      11.2      0.25 bfb_c_sfi  bfb0802       0.28
## 3         0      12.8      0.25 bfb_c_sfi  bfb0802      -0.08
## 4         3      12.6      0.25 bfb_c_sfi  bfb0802       0.31
## 5        16      12.2      0.25 bfb_c_sfi  bfb0802       0.17
## 6        12      11.5      0.25 bfb_c_sfi  bfb0802       0.14</code></pre>
</div>
<div id="sandbox" class="section level4">
<h4 class="hasAnchor">
<a href="#sandbox" class="anchor"></a><strong>sandbox</strong>
</h4>
<p>And finally, the <code>sandbox</code> is where you will save all those scripts in which you are trying out stuff. This is a personal recommendation of mine; a folder where you can save all your playing around with models and data.</p>
</div>
</div>
<div id="where-did-you-find-all-this" class="section level3">
<h3 class="hasAnchor">
<a href="#where-did-you-find-all-this" class="anchor"></a><strong>Where did you find all this?</strong>
</h3>
<p>Everything I have explained is extracted from the book “<strong>R packages</strong>” by the most awesome <strong>Hadley Wickham</strong>, the head developer for Rstudio and co-author of packages as awesome as <code>tidyverse</code>, <code>ggplot2</code>, <code>pkgdown</code> etc. The book is absolutely free and you can find it here: <a href="https://r-pkgs.org/" class="uri">https://r-pkgs.org/</a> and it has many more awesome things I did not develop here! Feel free to check it out!</p>
<br><center>
<img src="images/rpak_wickham.jpg"><figcaption>
The main man Hadley Wickham himself. I want to be like him when I grow up.
</figcaption>
</center>
<p><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
