<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with `R` packages • cataract</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with `R` packages">
<meta property="og:description" content="cataract">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cataract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/git.html">What is Git?</a>
</li>
<li>
  <a href="../articles/r_packages.html">R packages</a>
</li>
<li>
  <a href="../articles/github.html">What is GitHub?</a>
</li>
<li>
  <a href="../articles/pages.html">GitHub Pages</a>
</li>
<li>
  <a href="../articles/resources.html">Resources</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="r_packages_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="r_packages_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with <code>R</code> packages</h1>
            
      
      
      <div class="hidden name"><code>r_packages.Rmd</code></div>

    </div>

    
    
<div id="aim-of-the-game" class="section level3">
<h3 class="hasAnchor">
<a href="#aim-of-the-game" class="anchor"></a><strong>Aim of the Game</strong>
</h3>
<p>Have you ever been in that situation where your R script is painfully long? Something like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># first remove everything on the environment</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># then install the packages you need </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">install.packages</span>(<span class="st">"ggplot2"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">install.packages</span>(<span class="st">"nlmer"</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">install.packages</span>(<span class="st">"rethinking"</span>)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">install.packages</span>(<span class="st">"whatever"</span>)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">install.packages</span>(<span class="st">"some bullshit I need 4 just that one line"</span>)</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># then load the packages </span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">library</span>(nlmer)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">library</span>(rethinking)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">library</span>(whatever)</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">library</span>(some bullshit I need <span class="dv">4</span> just that one line)</a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># then load the data </span></a>
<a class="sourceLine" id="cb1-19" title="19">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(C<span class="op">:</span><span class="er">/</span>was_it_this_folder?<span class="op">/</span>within_this_one?<span class="op">/</span>not_sure<span class="op">/</span>maybe_here?<span class="op">/</span>data.csv)</a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># then tidy the raw data and only keep what you need for your analysis </span></a>
<a class="sourceLine" id="cb1-22" title="22">actual_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">unicorn_id =</span> data<span class="op">$</span>UniCorn_Identity,</a>
<a class="sourceLine" id="cb1-23" title="23">                          <span class="dt">horn_length =</span> data<span class="op">$</span>Length_of_THe_horn_of_the_UNicorn, </a>
<a class="sourceLine" id="cb1-24" title="24">                          <span class="dt">weight =</span> data<span class="op">$</span>W_of_the_Unicorn_when_born)</a>
<a class="sourceLine" id="cb1-25" title="25"></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co"># to then finally be able to run the fricking analysis </span></a>
<a class="sourceLine" id="cb1-27" title="27">model &lt;-<span class="st"> </span><span class="kw">lm</span>(horn_length <span class="op">~</span><span class="st"> </span>weight, actual_data)</a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co"># to then get a fricking ERROR AGAIN GODDAMN IT! </span></a></code></pre></div>
<p><br></p>
<p>Installing packages, loading them, cleaning data, preparing it for analysis, doing the analysis and plotting the results all within the same file can result in absurdly long <code>R</code> scripts. There is a way to solve this and it is by treating your entire research project as an <strong><code>R</code> package</strong>. Let me explain:</p>
</div>
<div id="what-is-an-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-an-r-package" class="anchor"></a><strong>What is an <code>R</code> package?</strong>
</h3>
<p>An <strong><code>R</code> package</strong> is a type of <strong><code>R</code> project</strong>, in other words, a way to work with <code>R</code> on a specific topic. A package, just like any project, is set up from a folder in your computer that you set up where you store all your files and data. If you develop your own <code>R</code> package it will work similarly to those packages you install and load every time you run an <code>R</code> script (i.e <code>ggplot2</code>, <code>nlmer</code> etc.) when you need a function that does something useful, only this time, you will be the person behind the scenes!</p>
<p>A package can include, <strong>functions</strong>, <strong>data</strong>, and all kinds of scripts to process or document your work. As an example, I have developed the package <code>cataract</code> por the EcoLunch presentation. I can load this package and with it I can specify other packages that need to be both installed and loaded with it with the function</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>When loading the package I can also access functions that I have written myself to perform specific tasks. For example, here is a function that generates facts about <strong>Chris H.</strong> with different degrees (1-5) of spicyness:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/generate_chris_fact.html">generate_chris_fact</a></span><span class="op">(</span>spicyness <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Chris has an awesome mustache"</code></pre>
<p><br> I can also access any data sets I am working with. I can actually save them after being processed and with the variables I want so when I load them they are ready to be played with. As an example, I have added some <strong>avengers</strong> data to the <code>cataract</code> project:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># just typing the dataset's name when the package is loaded will make the data pop up!</span>
<span class="va">avengers</span></code></pre></div>
<pre><code>##               name intelligence power
## 1    black panther           88    66
## 2      black widow           75    32
## 3  captain america           63    65
## 4   captain marvel           80    95
## 5   doctor strange           95    84
## 6           falcon           63    30
## 7            groot            6    75
## 8          hawkeye           70    35
## 9             hulk           10    94
## 10        iron man           99    67
## 11  scarlett witch           96   100
## 12          vision          100    96
## 13  winter soldier           55    64
## 14            thor           60    90</code></pre>
<p><br></p>
<p>And this is just the tip of the iceberg of the things you can do with your <code>R</code> package! Would you be interested in creating one for yourself? Here are some tips:</p>
</div>
<div id="creating-your-own-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-your-own-r-package" class="anchor"></a><strong>Creating your own <code>R</code> package</strong>
</h3>
<p><em>Okay dude but how in the hell do you actually do this?</em> No problem! Here is a step by step tutorial for you:</p>
<div id="step-1" class="section level5">
<h5 class="hasAnchor">
<a href="#step-1" class="anchor"></a><strong>Step 1</strong>
</h5>
<p>Have you ever noticed when you open Rstudio that little <strong>R</strong> sign that says something like <code>Project:(None)</code>. Click there and go to <code>New Project</code>.</p>
<center>
<img src="images/rpak_project_none.png">
</center>
<p><br></p>
</div>
<div id="step-2" class="section level5">
<h5 class="hasAnchor">
<a href="#step-2" class="anchor"></a><strong>Step 2</strong>
</h5>
<p>Then this window will pop up, we want a <code>New Directory</code>.</p>
<br><center>
<img src="images/rpak_create_project.png" width="600">
</center>
<p><br></p>
</div>
<div id="step-3" class="section level5">
<h5 class="hasAnchor">
<a href="#step-3" class="anchor"></a><strong>Step 3</strong>
</h5>
<p>Here we will choose <code>R package</code>.</p>
<br><center>
<img src="images/rpak_project_type.png" width="600">
</center>
<p><br></p>
</div>
<div id="step-4" class="section level5">
<h5 class="hasAnchor">
<a href="#step-4" class="anchor"></a><strong>Step 4</strong>
</h5>
<p>Which will open this:</p>
<br><center>
<img src="images/rpak_create_package.png" width="600">
</center>
<p><br></p>
<p>Three things to consider here:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>
<strong>Name of your package</strong>: Package naming needs to meet certain formalities. In this link: <a href="https://r-pkgs.org/workflows101.html?q=namin#naming" class="uri">https://r-pkgs.org/workflows101.html?q=namin#naming</a> you will find them as well as some pragmatic advice on naming. My personal recommendation is to name your packages with a <strong>single word</strong> that is descriptive enough and that motivates you to work on it. What I do is name my packages using extremely geeky associations which are related with what the package is about in a funny way.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>
<strong>Make sure you create the folder for the package on a directory you know!</strong>: You can set it up on your Desktop, that’s fine! But remember it is there!. What I recommend, as kind of a technological tidiness nerd is to create a specialized folder for <code>projects</code> where you can locate all your work!</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>
<strong>Don’t forget about <code>GIT</code>!</strong> You should have <strong>GIT</strong> installed in your computer right now (if not go to: <a href="https://ggcostoya.github.io/cataract/articles/git.html" class="uri">https://ggcostoya.github.io/cataract/articles/git.html</a> and check how to do it). If you indeed have it, a little check box with <code>Create git repository</code> should appear in this screen. Be sure to check that box! It will be essential later.</li>
</ol></li>
</ul>
<p>Once you are done, click on <code>Create Project</code> and <strong>KABOOM!</strong> Congrats! You’ve created your first <code>R</code> package, now it’s time to see what is going on here.</p>
</div>
</div>
<div id="elements-of-your-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#elements-of-your-r-package" class="anchor"></a><strong>Elements of your <code>R</code> package</strong>
</h3>
<p>As soon as you create your <code>R</code> package you will see that a bunch of folders automatically appear on the folder for it. You can see these in the lower right-hand panel in Rstudio where it says <code>Files</code>, it should look something like this:</p>
<br><center>
<img src="images/rpak_files.png" width="600">
</center>
<p><br></p>
<p>Among these files and documents the ones you got to pay attention to are:</p>
<div id="rproj" class="section level4">
<h4 class="hasAnchor">
<a href="#rproj" class="anchor"></a><strong><code>.Rproj</code></strong>
</h4>
<p>The <code>.Rproj</code> file is the source to all of your <code>R</code> package. In this case, as an example, I’ve created the <code>kurama</code> package so in the picture above you see <code>kurama.Rproj</code>. When you create projects of your own the <code>.Rproj</code> file will be your package’s name. If you go to the folder where you created the package and click on it an <code>R</code> session with your package name will appear. Notice also that on the top right hand side it doesn’t say <code>Project:(None)</code> anymore! The name of your package should appear up there.</p>
</div>
<div id="description" class="section level4">
<h4 class="hasAnchor">
<a href="#description" class="anchor"></a><strong><code>DESCRIPTION</code></strong>
</h4>
<p>The <code>DESCRIPTION</code> file contains all the information related to your project. If you open it, it should look like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">Package<span class="op">:</span><span class="st"> </span>kurama <span class="co"># here's my example, but here the name of your package will appear. </span></a>
<a class="sourceLine" id="cb7-2" title="2">Type<span class="op">:</span><span class="st"> </span>Package</a>
<a class="sourceLine" id="cb7-3" title="3">Title<span class="op">:</span><span class="st"> </span>What the Package <span class="kw">Does</span> (Title Case)</a>
<a class="sourceLine" id="cb7-4" title="4">Version<span class="op">:</span><span class="st"> </span><span class="dv">0</span>.<span class="fl">1.0</span></a>
<a class="sourceLine" id="cb7-5" title="5">Author<span class="op">:</span><span class="st"> </span>Who wrote it</a>
<a class="sourceLine" id="cb7-6" title="6">Maintainer<span class="op">:</span><span class="st"> </span>The package maintainer <span class="op">&lt;</span>yourself<span class="op">@</span>somewhere.net<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-7" title="7">Description<span class="op">:</span><span class="st"> </span>More about what it <span class="kw">does</span> (maybe more than one line)</a>
<a class="sourceLine" id="cb7-8" title="8">    Use four spaces when indenting paragraphs within the Description.</a>
<a class="sourceLine" id="cb7-9" title="9">License<span class="op">:</span><span class="st"> </span>What license is it under?</a>
<a class="sourceLine" id="cb7-10" title="10">Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="dv">-8</span></a>
<a class="sourceLine" id="cb7-11" title="11">LazyData<span class="op">:</span><span class="st"> </span>true</a></code></pre></div>
<p>The <code>DESCRIPTION</code> file can include all <strong>Dependencies</strong>, which are all packages that need to be installed and loaded for your package to run. You will need to add them manually. You can also add information about the package (title, author, description etc.). As an example, here is the <code>DESCRIPTION</code> file for <code>cataract</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">Package<span class="op">:</span><span class="st"> </span>cataract</a>
<a class="sourceLine" id="cb8-2" title="2">Type<span class="op">:</span><span class="st"> </span>Package</a>
<a class="sourceLine" id="cb8-3" title="3">Title<span class="op">:</span><span class="st"> </span>Project Cataract</a>
<a class="sourceLine" id="cb8-4" title="4">Version<span class="op">:</span><span class="st"> </span><span class="fl">1.0</span></a>
<a class="sourceLine" id="cb8-5" title="5">Author<span class="op">:</span><span class="st"> </span>Guillermo Garcia Costoya</a>
<a class="sourceLine" id="cb8-6" title="6">Maintainer<span class="op">:</span><span class="st"> </span>Guillermo Garcia Costoya <span class="op">&lt;</span>guille<span class="op">@</span>nevada.unr.edu<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-7" title="7">Description<span class="op">:</span><span class="st"> </span>A quick guide on how to use GIT, R packages, GitHub and GitHub pages</a>
<a class="sourceLine" id="cb8-8" title="8">    as part of your research process to keep your files and data tidy, tracked, organized</a>
<a class="sourceLine" id="cb8-9" title="9">    and kewl. A package develop to complement the April 30th <span class="dv">2021</span> EcoLunch talk by </a>
<a class="sourceLine" id="cb8-10" title="10">    Guillermo Garcia Costoya at the EECB program of the University of Nevada, Reno</a>
<a class="sourceLine" id="cb8-11" title="11">License<span class="op">:</span><span class="st"> </span>What license is it under?</a>
<a class="sourceLine" id="cb8-12" title="12">Encoding<span class="op">:</span><span class="st"> </span>UTF<span class="dv">-8</span></a>
<a class="sourceLine" id="cb8-13" title="13">LazyData<span class="op">:</span><span class="st"> </span>true</a>
<a class="sourceLine" id="cb8-14" title="14">Depends<span class="op">:</span><span class="st">  </span><span class="co">## Here you will need to specify the packages you want to be installed and loaded!</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="st">    </span><span class="kw">R</span>(<span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>.<span class="fl">3.0</span>),</a>
<a class="sourceLine" id="cb8-16" title="16">    tidyverse,</a>
<a class="sourceLine" id="cb8-17" title="17">    devtools,</a>
<a class="sourceLine" id="cb8-18" title="18">    DescTools, </a>
<a class="sourceLine" id="cb8-19" title="19">    gridExtra,</a>
<a class="sourceLine" id="cb8-20" title="20">    here</a>
<a class="sourceLine" id="cb8-21" title="21">RoxygenNote<span class="op">:</span><span class="st"> </span><span class="dv">7</span>.<span class="fl">1.1</span> <span class="co">## Do me a favor and add this as well if you are copy pasting. It's for your own good. </span></a></code></pre></div>
<p>Setting up a <code>DESCRIPTION</code> file like this saves you the trouble of having to install and load packages every time. You just need to include them as <em>Dependencies</em> and <strong>BOOM!</strong> They will be loaded every time you load your <code>R</code> package!</p>
</div>
<div id="r" class="section level4">
<h4 class="hasAnchor">
<a href="#r" class="anchor"></a><strong><code>\R</code></strong>
</h4>
<p>The <code>\R</code> folder will contain all the functions for your package. If you click there as soon as you create your package you’ll see that <code>R</code> has automatically created a function called <code>hello</code>, which is saved on the <code>hello.R</code> file that looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Hello, world!</span>
<span class="co">#</span>
<span class="co"># This is an example function named 'hello' </span>
<span class="co"># which prints 'Hello, world!'.</span>
<span class="co">#</span>
<span class="co"># You can learn more about package authoring with RStudio at:</span>
<span class="co">#</span>
<span class="co">#   http://r-pkgs.had.co.nz/</span>
<span class="co">#</span>
<span class="co"># Some useful keyboard shortcuts for package authoring:</span>
<span class="co">#</span>
<span class="co">#   Install Package:           'Ctrl + Shift + B'</span>
<span class="co">#   Check Package:             'Ctrl + Shift + E'</span>
<span class="co">#   Test Package:              'Ctrl + Shift + T'</span>

<span class="va">hello</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Hello, world!"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><br> The goal here is that you create functions for yourself to make tasks easier and more repeatable. Writing your own functions is a way to avoid repetitions and keep your code short. For example, let’s say that for the <code>avengers</code> data set I showed you earlier I want to determine who would win in a fight between <strong>Vision</strong> and <strong>Thor</strong>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's check the data first once again: </span>
<span class="va">avengers</span></code></pre></div>
<pre><code>##               name intelligence power
## 1    black panther           88    66
## 2      black widow           75    32
## 3  captain america           63    65
## 4   captain marvel           80    95
## 5   doctor strange           95    84
## 6           falcon           63    30
## 7            groot            6    75
## 8          hawkeye           70    35
## 9             hulk           10    94
## 10        iron man           99    67
## 11  scarlett witch           96   100
## 12          vision          100    96
## 13  winter soldier           55    64
## 14            thor           60    90</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># filter the data to keep only data for vision and thor </span>
<span class="va">avg_vision_thor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">avengers</span>, <span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vision"</span>, <span class="st">"thor"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># keep the avenger with the highest power value </span>
<span class="va">winner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">avg_vision_thor</span>, <span class="va">power</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span><span class="op">)</span>
<span class="co"># extract the name of the winner </span>
<span class="va">name_winner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">winner</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
<span class="co"># and here's the winner! VISION! of course... </span>
<span class="va">name_winner</span></code></pre></div>
<pre><code>## [1] "vision"</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># what if I needed to know who would win between scarlett witch and hulk? </span>
<span class="co"># Redo the entire shannanigan again? HELL NO! </span>
<span class="co"># I can write a function to automate this process. I can call this function "match_avengers": </span>

<span class="va">match_avengers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">avg_1</span>, <span class="va">avg_2</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># avg_1 and avg_2 are the arguments of the function,</span>
  <span class="co"># filter avenger data and keep only two specified avengers as well as the most powerful one</span>
  <span class="va">match</span> <span class="op">&lt;-</span> <span class="va">avengers</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">avg_1</span>, <span class="va">avg_2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">power</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># get the name of the winner</span>
  <span class="va">winner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">match</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">winner</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># let's test the function out! SCARLETT WITCH ALL DAY!! </span>
<span class="fu"><a href="../reference/match_avengers.html">match_avengers</a></span><span class="op">(</span><span class="st">"scarlett witch"</span>, <span class="st">"hulk"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "scarlett witch"</code></pre>
<p><br> If you check the <code>\R</code> folder for the <code>cataract</code> package here: <a href="https://github.com/ggcostoya/cataract/tree/master/R" class="uri">https://github.com/ggcostoya/cataract/tree/master/R</a> , you’ll see that one of the files there is for the <code>match_avengers</code> function. If it is there I can use the function any time <code>cataract</code> is loaded!</p>
</div>
<div id="gitignore" class="section level4">
<h4 class="hasAnchor">
<a href="#gitignore" class="anchor"></a><strong><code>.gitignore</code></strong>
</h4>
<p>The <code>.gitignore</code> file will specify which files or folders you don’t want <code>GIT</code> tracking version-control style. For example, a good addition to <code>.gitignore</code> is the <code>.Rproj</code> file, it will never change, why keep track of it?</p>
</div>
</div>
<div id="elements-you-need-to-add-to-your-r-package" class="section level3">
<h3 class="hasAnchor">
<a href="#elements-you-need-to-add-to-your-r-package" class="anchor"></a><strong>Elements you NEED TO ADD to your <code>R</code> package</strong>
</h3>
<p>Although the package would work with the basic stuff that is generated when you created, to upgrade your <code>R</code> package to the next level you’ll need to create the following folders:</p>
<div id="raw_data" class="section level4">
<h4 class="hasAnchor">
<a href="#raw_data" class="anchor"></a><strong><code>\raw_data</code></strong>
</h4>
<p>In the <code>\raw_data</code> folder you will save all data that comes fresh from the field or the lab. I am talking about those messy excels, <code>.txt</code> files, <code>.csv</code> files anything! All in there. The <code>\raw_data</code> folder will also contain what I call <strong>cleaning scripts</strong>. These will have all the data processing, filtering and cleaning necessary for your raw data to become the actual data you’ll use in your scripts.</p>
<p>If you go to: <a href="https://github.com/ggcostoya/cataract/tree/master/raw_data" class="uri">https://github.com/ggcostoya/cataract/tree/master/raw_data</a>, you’ll be to see the raw data for the <code>cataract</code>. As an example I have included some <code>meerkats</code> data a friend of mine used for a project a couple of years ago. Below is an an example <strong>cleaning script</strong> (called <code>meerkats_data_prep.R</code>):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Meerkat data preparation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/krlmlr/here">here</a></span><span class="op">)</span> <span class="co"># load here package</span>
<span class="va">meerkats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"raw_data"</span>, <span class="st">"meerkats.txt"</span><span class="op">)</span><span class="op">)</span> <span class="co"># load the raw meerkat data</span>
<span class="co"># rename some columns to make analysis easier</span>
<span class="va">meerkats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>obs_feeds <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">observedNfeeds</span>,
                       obs_hours <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">observedhours</span>,
                       r_2_brood <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">relatedness2brood</span>,
                       group_id <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">socialgroupID</span>,
                       brood_id <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">broodID</span>,
                       delta_mass <span class="op">=</span> <span class="va">meerkats</span><span class="op">$</span><span class="va">massChange</span><span class="op">)</span>

<span class="co"># save meerkat data in "data" folder</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">meerkats</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data"</span>, <span class="st">"meerkats.RData"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>As you see above, I am reading it, renaming some variables to make it look prettier and easier to handle when running stats on it and finally I am saving it in the <code>\data</code> folder, which I’ll talk about next:</p>
</div>
<div id="data" class="section level4">
<h4 class="hasAnchor">
<a href="#data" class="anchor"></a><strong><code>\data</code></strong>
</h4>
<p>The <code>\data</code> folder will contain the actual data you will use in your scripts (in <code>.RData</code> format) and will be available to you immediately after you load your <code>R</code> package. As an example, I can take a look at the <code>meerkats</code> data without having to load anything because it is saved in the <code>data</code> folder!</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">meerkats</span><span class="op">)</span></code></pre></div>
<pre><code>##   obs_feeds obs_hours r_2_brood  group_id brood_id delta_mass
## 1         0      11.1      0.25 bfb_c_sfi  bfb0802      -0.03
## 2         0      11.2      0.25 bfb_c_sfi  bfb0802       0.28
## 3         0      12.8      0.25 bfb_c_sfi  bfb0802      -0.08
## 4         3      12.6      0.25 bfb_c_sfi  bfb0802       0.31
## 5        16      12.2      0.25 bfb_c_sfi  bfb0802       0.17
## 6        12      11.5      0.25 bfb_c_sfi  bfb0802       0.14</code></pre>
<p><br></p>
</div>
<div id="sandbox" class="section level4">
<h4 class="hasAnchor">
<a href="#sandbox" class="anchor"></a><strong><code>\sandbox</code></strong>
</h4>
<p>And finally, the <code>\sandbox</code> is where you will save all those scripts in which you are trying out stuff. This is a <strong>personal recommendation</strong> of mine; a folder where you can save all your playing around with models and data.</p>
</div>
</div>
<div id="where-did-you-find-all-this" class="section level3">
<h3 class="hasAnchor">
<a href="#where-did-you-find-all-this" class="anchor"></a><strong>Where did you find all this?</strong>
</h3>
<p>Everything I have explained is extracted from the book “<strong><code>R</code> packages</strong>” by the most awesome <strong>Hadley Wickham</strong>, the head developer for Rstudio and co-author of packages as awesome as <code>tidyverse</code>, <code>ggplot2</code>, <code>pkgdown</code> etc. The book is absolutely free and you can find it here: <a href="https://r-pkgs.org/" class="uri">https://r-pkgs.org/</a>. It has soo many more awesome things I did not develop here! Feel free to check it out!</p>
<br><center>
<img src="images/rpak_wickham.jpg"><figcaption>
The main man Hadley Wickham himself. I want to be like him when I grow up.
</figcaption>
</center>
<p><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Guillermo Garcia Costoya.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
